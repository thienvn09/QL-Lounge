CREATE DATABASE QLBONGDA;
Go 
Use QLBONGDA;
Go
CREATE TABLE CAUTHU(
	MACT INT IDENTITY(1,1) PRIMARY KEY,
	HOTEN NVARCHAR(100) NOT NULL,
	VITRI NVARCHAR(20) NOT NULL,
	NGAYSINH DATETIME,
	DIACHI NVARCHAR(200),
	MACLB VARCHAR(5) NOT NULL,
	MAQG VARCHAR(5) NOT NULL,
	SO INT NOT NULL,
);
CREATE TABLE QUOCGIA(
	MAQG VARCHAR(5) PRIMARY KEY NOT NULL,
	TENQG NVARCHAR(60) NOT NULL,
); 
CREATE TABLE CAULACBO(
	MACLB VARCHAR(5) PRIMARY KEY NOT NULL,
	TENCLB NVARCHAR(100) NOT NULL,
	MASAN VARCHAR (5) NOT NULL,
	MATINH VARCHAR(5) NOT NULL, 
);
CREATE TABLE TINH(
	MATINH VARCHAR(5) PRIMARY KEY NOT NULL,
	TENTINH NVARCHAR(100) NOT NULL,
);
CREATE TABLE HUANLUYENVIEN(
	MAHLV VARCHAR(5) PRIMARY KEY NOT NULL,
	TENHLV NVARCHAR(100) NOT NULL,
	NGAYSINH DATETIME ,
	DIACHI NVARCHAR(200),
	DIENTHOAI NVARCHAR(20),
	MAQG VARCHAR(5) NOT NULL,
);
CREATE TABLE HLV_CLB(
	MAHLC VARCHAR(5) NOT NULL,
	MACLB VARCHAR(5) NOT NULL,
	VAITRO NVARCHAR(100) NOT NULL,
	PRIMARY KEY (MAHLC, MACLB),
);
CREATE TABLE SANVD(
	MASAN VARCHAR(5) NOT NULL,
	TENSAN NVARCHAR(100) NOT NULL,
	DIACHI NVARCHAR(200) ,
	PRIMARY KEY(MASAN),
);
CREATE TABLE TRANDAU(
	MATRAN INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
	NAM INT NOT NULL,
	VONG INT NOT NULL,
	NGAYTD DATETIME NOT NULL,
	MACLB1 VARCHAR(5) NOT NULL,
	MACLB2 VARCHAR(5) NOT NULL,
	MASAN VARCHAR(5) NOT NULL,
	KETQUA VARCHAR(5) NOT NULL,
);
CREATE TABLE BANGXH(
	MACLB VARCHAR(5) NOT NULL ,
	NAM INT NOT NULL,
	VONG INT NOT NULL,
	SOTRAN INT NOT NULL,
	THANG INT NOT NULL,
	HOA INT NOT NULL,
	THUA INT NOT NULL,
	HIEUSO VARCHAR(5) NOT NULL,
	DIEM INT NOT NULL,
	HANG INT NOT NULL,
	PRIMARY KEY(MACLB,NAM,VONG),
);
/* KHOA NGOAI */
ALTER TABLE CAUTHU
ADD CONSTRAINT FK_CAUTHU_CLB FOREIGN KEY (MACLB) REFERENCES CAULACBO(MACLB);

ALTER TABLE CAUTHU
ADD CONSTRAINT FK_CAUTHU_QG FOREIGN KEY (MAQG) REFERENCES QUOCGIA(MAQG);

ALTER TABLE TRANDAU
ADD CONSTRAINT FK_TRANDAUCLB_1 FOREIGN KEY (MACLB1) REFERENCES CAULACBO(MACLB);

ALTER TABLE TRANDAU
ADD CONSTRAINT FK_TRANDAUCLB_2 FOREIGN KEY (MACLB2) REFERENCES CAULACBO(MACLB);

ALTER TABLE TRANDAU
ADD CONSTRAINT FK_MASAN FOREIGN KEY(MASAN) REFERENCES SANVD(MASAN);

ALTER TABLE CAULACBO
ADD CONSTRAINT FK_CAULACBO_SAN FOREIGN KEY (MASAN) REFERENCES SANVD(MASAN);

ALTER TABLE CAULACBO
ADD CONSTRAINT FK_CAULACBO_TINH FOREIGN KEY (MATINH) REFERENCES TINH(MATINH);

ALTER TABLE HUANLUYENVIEN
ADD CONSTRAINT FK_HLV_QG FOREIGN KEY(MAQG) REFERENCES QUOCGIA(MAQG);

ALTER TABLE HLV_CLB
ADD CONSTRAINT FK_HLV_CLB_HLV FOREIGN KEY(MAHLC) REFERENCES HUANLUYENVIEN(MAHLV);

ALTER TABLE HLV_CLB
ADD CONSTRAINT FK_HLV_CLB_CLB FOREIGN KEY (MACLB) REFERENCES CAULACBO(MACLB);

ALTER TABLE BANGXH
ADD CONSTRAINT FK_BANGXH_CLB FOREIGN KEY (MACLB) REFERENCES CAULACBO(MACLB);


/* bảng tỉnh */
INSERT INTO TINH VALUES ('BD', N'Bình Dương'); 
INSERT INTO TINH VALUES ('DN', N'Đà Nẵng'); 
INSERT INTO TINH VALUES ('GL', N'Gia Lai'); 
INSERT INTO TINH VALUES ('KH', N'Khánh Hòa'); 
INSERT INTO TINH VALUES ('LA', N'Long An'); 
INSERT INTO TINH VALUES ('PY', N'Phú Yên');


/* bảng quốc gia */
INSERT INTO QUOCGIA VALUES ('ANH' , N'Anh Quốc'); 
INSERT INTO QUOCGIA VALUES ('BDN' , N'Bồ Đào Nha'); 
INSERT INTO QUOCGIA VALUES ('BRA' , N'Bra-xin'); 
INSERT INTO QUOCGIA VALUES ('ITA' , N'Ý'); 
INSERT INTO QUOCGIA VALUES ('TBN' , N'Tây Ban Nha'); 
INSERT INTO QUOCGIA VALUES ('THA' , N'Thái Lan'); 
INSERT INTO QUOCGIA VALUES ('THAI' , N'Thái Lan'); 
INSERT INTO QUOCGIA VALUES ('VN' , N'Việt Nam'); 


/* Bảng sân */
INSERT INTO SANVD VALUES ('CL' , N'Chi Lăng' ,N'127 Võ Văn Tần, Đà Nẵng'); 
INSERT INTO SANVD VALUES ('GD' , N'Gò Đậu' ,N'123 QL1, TX Thủ Dầu Một, Bình Dương'); 
INSERT INTO SANVD VALUES ('LA' , N'Long An' ,N'102 Hùng Vương, Tp Tân An, Long An'); 
INSERT INTO SANVD VALUES ('NT' , N'Nha Trang' ,N'128 Phan Chu Trinh, Nha Trang, Khánh Hòa'); 
INSERT INTO SANVD VALUES ('PL' , N'Pleiku' ,N'22 Hồ Tùng Mậu, Thống Nhất, Thị xã Pleiku, Gia Lai'); 
INSERT INTO SANVD VALUES ('TH' , N'Tuy Hòa' ,N'57 Trường Chinh, Tuy Hòa, Phú Yên'); 

/* CLB */
INSERT INTO CAULACBO VALUES ('BBD' , N'BECAMEX BÌNH DƯƠNG' ,'GD','BD'); 
INSERT INTO CAULACBO VALUES ('GDT' , N'GẠCH ĐỒNG TÂM LONG AN' ,'LA','LA'); 
INSERT INTO CAULACBO VALUES ('HAGL' , N'HOÀNG ANH GIA LAI' ,'PL','GL'); 
INSERT INTO CAULACBO VALUES ('KKH' , N'KHATOCO KHÁNH HÒA' ,'NT','KH'); 
INSERT INTO CAULACBO VALUES ('SDN' , N'SHB ĐÀ NẴNG' ,'CL','DN'); 
INSERT INTO CAULACBO VALUES ('TPY' , N'THÉP PHÚ YÊN' ,'TH','PY'); 

/* HLV */
INSERT INTO HUANLUYENVIEN VALUES ('HLV01' , N'Vital' ,'1955-10-15 00:00:00.000','NULL' ,'918011075' ,'BDN'); 
INSERT INTO HUANLUYENVIEN VALUES ('HLV02' , N'Lê Huỳnh Đức' ,'1972-05-20 00:00:00.000','NULL' ,'1223456789' ,'VN'); 
INSERT INTO HUANLUYENVIEN VALUES ('HLV03' , N'Kiatisuk' ,'1970-12-11 00:00:00.000','NULL' ,'1990123456' ,'THA'); 
INSERT INTO HUANLUYENVIEN VALUES ('HLV04' , N'Hoàng Anh Tuấn' ,'1970-06-10 00:00:00.000','NULL' ,'989112233' ,'VN'); 
INSERT INTO HUANLUYENVIEN VALUES ('HLV05' , N'Trần Công Minh' ,'1973-07-07 00:00:00.000','NULL' ,'909099990' ,'VN'); 
INSERT INTO HUANLUYENVIEN VALUES ('HLV06' , N'Trần Văn Phúc' ,'1965-03-02 00:00:00.000','NULL' ,'1650101234' ,'VN'); 

/* Cau thủ */
SET IDENTITY_INSERT [dbo].[CAUTHU] ON;
INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (1, N'Nguyễn Vũ Phong', N'Tiền vệ', '1990-02-20 00:00:00.000', NULL, 'BBD', 'VN', 17);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (2, N'Nguyễn Công Vinh', N'Tiền đạo', '1992-03-10 00:00:00.000', NULL, 'HAGL', 'VN', 9);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (6, N'Trần Tấn Tài', N'Tiền vệ', '1989-11-12 00:00:00.000', NULL, 'BBD', 'VN', 8);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (7, N'Phan Hồng Sơn', N'Thủ môn', '1991-06-10 00:00:00.000', NULL, 'HAGL', 'VN', 1);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (9, N'Ronaldo', N'Tiền vệ', '1989-12-12 00:00:00.000', NULL, 'SDN', 'BRA', 7);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (10, N'Robinho', N'Tiền vệ', '1989-10-12 00:00:00.000', NULL, 'SDN', 'BRA', 8);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (11, N'Vidic', N'Hậu vệ', '1987-10-15 00:00:00.000', NULL, 'HAGL', 'ANH', 3);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (12, N'Trần Văn Santos', N'Thủ môn', '1990-10-21 00:00:00.000', NULL, 'BBD', 'BRA', 1);  

INSERT INTO CAUTHU (MACT, HOTEN, VITRI, NGAYSINH, DIACHI, MACLB, MAQG, SO)  
VALUES (13, N'Nguyễn Trường Sơn', N'Hậu vệ', '1993-08-26 00:00:00.000', NULL, 'BBD', 'VN', 4);  

SET IDENTITY_INSERT [dbo].[CAUTHU] OFF;
GO

/* HLV_CLB */
INSERT INTO HLV_CLB VALUES ('HLV01' , 'BBD' ,N'HLV Chính'); 
INSERT INTO HLV_CLB VALUES ('HLV02' , 'SDN' ,N'HLV Chính'); 
INSERT INTO HLV_CLB VALUES ('HLV03' , 'HAGL' ,N'HLV Chính'); 
INSERT INTO HLV_CLB VALUES ('HLV04' , 'KKH' ,N'HLV Chính'); 
INSERT INTO HLV_CLB VALUES ('HLV05' , 'GDT' ,N'HLV Chính'); 
INSERT INTO HLV_CLB VALUES ('HLV06' , 'BBD' ,N'HLV Thủ môn'); 



/* TRANDAU */

SET IDENTITY_INSERT [dbo].[TRANDAU] ON;
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (1 , '2009' ,'1','2009-02-07 00:00:00.000' ,'BBD' ,'SDN','GD', '3-0' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (2 , '2009' ,'1','2009-02-07 00:00:00.000' ,'KKH' ,'GDT','NT', '1-1' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (3 , '2009' ,'2','2009-02-16 00:00:00.000' ,'SDN' ,'KKH','CL', '2-2' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (4 , '2009' ,'2','2009-02-16 00:00:00.000' ,'TPY' ,'BBD','TH', '5-0' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (5 , '2009' ,'3','2009-03-01 00:00:00.000' ,'TPY' ,'GDT','TH', '0-2' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (6 , '2009' ,'3','2009-03-01 00:00:00.000' ,'KKH' ,'BBD','NT', '0-1' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (7, '2009' ,'4','2009-03-07 00:00:00.000' ,'KKH' ,'TPY','NT', '1-0' ); 
INSERT INTO TRANDAU (MATRAN,NAM,VONG,NGAYTD,MACLB1,MACLB2,MASAN,KETQUA)
VALUES (8 , '2009' ,'4','2009-03-07 00:00:00.000' ,'BBD' ,'GDT','GD', '2-2' ); 
SET IDENTITY_INSERT [dbo].[TRANDAU] OFF;
GO
/*BANGXH */

INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('BBD' ,'2009' ,'1','1' ,'1' ,'0','0', '3-0' ,'3','1'); 
INSERT INTO BANGXH 
VALUES('BBD' ,'2009' ,'2','2' ,'1' ,'0','1', '3-5' ,'3','2');  
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('BBD' ,'2009' ,'3','3' ,'2' ,'0','1', '4-5' ,'6','1'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('BBD' ,'2009' ,'4','4' ,'2' ,'1','1', '6-7' ,'7','1'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('GDT' ,'2009' ,'1','1' ,'0' ,'1','0', '1-1' ,'1','3'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('GDT' ,'2009' ,'2','1' ,'0' ,'1','0', '1-1' ,'1','4'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('GDT' ,'2009' ,'3','2' ,'1' ,'1','0', '3-1' ,'4','2'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('GDT' ,'2009' ,'4','3' ,'1' ,'2','0', '5-1' ,'5','2'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('KKH' ,'2009' ,'1','1' ,'0' ,'1','0', '1-1' ,'1','2'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('KKH' ,'2009' ,'2','2' ,'0' ,'2','0', '3-3' ,'2','3'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('KKH' ,'2009' ,'3','3' ,'0' ,'2','1', '3-4' ,'2','4'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('KKH' ,'2009' ,'4','4' ,'1' ,'2','1', '4-4' ,'5','3'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('SDN' ,'2009' ,'1','1' ,'0' ,'0','1', '0-3' ,'0','5'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('SDN' ,'2009' ,'2','2' ,'1' ,'1','0', '2-5' ,'1','5'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG)
VALUES ('SDN' ,'2009' ,'3','2' ,'1' ,'1','0', '2-5' ,'1','5'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('SDN' ,'2009' ,'4','2' ,'1' ,'1','0', '2-5' ,'1','5'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('TPY' ,'2009' ,'1','0' ,'0' ,'0','0', '0-0' ,'0','4'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('TPY' ,'2009' ,'2','1' ,'1' ,'0','0', '5-0' ,'3','1'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('TPY' ,'2009' ,'3','2' ,'1' ,'0','1', '5-2' ,'3','3'); 
INSERT INTO BANGXH(MACLB,NAM,VONG,SOTRAN,THANG,HOA,THUA,HIEUSO,DIEM,HANG) 
VALUES ('TPY' ,'2009' ,'4','3' ,'1' ,'0','2', '5-3' ,'3','4'); 

/* câu 1 */
Select MACT,HOTEN,So,VITRI,NGAYSINH,DIACHI 
From CAUTHU
/* CÂU 2 */
SELECT * 
FROM CAUTHU 
WHERE So='7'AND VITRI=N'Tiền vệ'
/* câu 3 */
SELECT TENHLV ,NGAYSINH,DIACHI,DIENTHOAI
FROM HUANLUYENVIEN
/* CÂU 4 */
Select MACT,HOTEN,So,VITRI,NGAYSINH,DIACHI 
From CAUTHU,CAULACBO as b 
WHERE b.TENCLB = N'SHB Đà Nẵng'  
/* câu 5 */
Select * 
From CAUTHU as a , QUOCGIA as q , CAULACBO as c
where q.TENQG = N'Việt Nam' AND c.TENCLB = N'Becamex Bình Dương'
/* câu 6 Hiển thị thông tin tất cả các cầu thủ đang thi đấu trong câu lạc bộ có sân nhà là 
“Hoàng Anh Gia Lai”.  */

SELECT C.MACT, C.HOTEN,C.VITRI, C.NGAYSINH, C.DIACHI,  C.MACLB, C.MAQG, C.SO
FROM CAUTHU C
JOIN CAULACBO CLB ON C.MACLB = CLB.MACLB
JOIN SANVD S ON CLB.MASAN = S.MASAN
WHERE S.TENSAN = N'Hoàng Anh Gia Lai';


/* CÂU 7 Cho biết kết quả (MATRAN, NGAYTD, TENSAN, TENCLB1, TENCLB2, KETQUA) các 
trận đấu vòng 2 của mùa bóng năm 2009.  */

SELECT T.MATRAN, T.NGAYTD, S.TENSAN, CLB1.TENCLB AS TENCLB1, CLB2.TENCLB AS TENCLB2, T.KETQUA
FROM TRANDAU T
JOIN SANVD S ON T.MASAN = S.MASAN
JOIN CAULACBO CLB1 ON T.MACLB1 = CLB1.MACLB
JOIN CAULACBO CLB2 ON T.MACLB2 = CLB2.MACLB
WHERE T.NAM = 2009 AND T.VONG = 2;
  
/* CÂU 8 Cho biết mã huấn luyện viên, tên, ngày sinh, địa chỉ, vai trò và tên CLB 
đang làm việc của các huấn luyện viên có quốc tịch “ViệtNam”. */
SELECT HLV.MAHLV, HLV.TENHLV, HLV.NGAYSINH, HLV.DIACHI, HLVCLB.VAITRO, CLB.TENCLB
FROM HUANLUYENVIEN HLV
JOIN QUOCGIA QG ON HLV.MAQG = QG.MAQG
JOIN HLV_CLB HLVCLB ON HLV.MAHLV = HLVCLB.MAHLC
JOIN CAULACBO CLB ON HLVCLB.MACLB = CLB.MACLB
WHERE QG.TENQG = N'Việt Nam';

/* CÂU 9 Lấy tên 3 câu lạc bộ có điểm cao nhất sau vòng 3 năm 2009. */
WITH BXH_RANKED AS (
    SELECT CLB.TENCLB, BXH.DIEM,
           RANK() OVER (ORDER BY BXH.DIEM DESC) AS RANK_NUM
    FROM BANGXH AS BXH
    JOIN CAULACBO AS CLB ON BXH.MACLB = CLB.MACLB
    WHERE BXH.VONG = 3 AND BXH.NAM = 2009
)
SELECT TENCLB, DIEM
FROM BXH_RANKED
WHERE RANK_NUM <= 3;

/* Cau 10  Cho biết mã huấn luyện viên, họ tên, ngày sinh, địa chỉ, vai trò và tên CLB đang làm việc 
mà câu lạc bộ đó đóng ở tỉnh Binh Dương. */
SELECT HLV.MAHLV , HLV.TENHLV ,HLV.NGAYSINH ,HLV.DIACHI,HLVCLB.VAITRO,CLB.TENCLB
FROM HUANLUYENVIEN AS HLV
	JOIN HLV_CLB AS HLVCLB ON HLV.MAHLV = HLVCLB.MAHLC
	JOIN CAULACBO AS CLB ON CLB.MACLB = HLVCLB.MACLB
	JOIN TINH AS T ON T.MATINH = CLB.MATINH
WHERE T.TENTINH LIKE N'Bình Dương'

-- CAU 1
SELECT clb.TENCLB, COUNT(c.MACT) as soluong 
FROM CAUTHU as c
	join CAULACBO as clb on clb.MACLB = c.MACLB
group by clb.TENCLB
-- cau 2
--  Thống kê số lượng cầu thủ nước ngoài (có quốc tịch khác Việt Nam) của mỗi câu lạc bộ
Select clb.MACLB,clb.TENCLB, COUNT( c.MACT) as SoLuongNuocNgoai
FROM CAUTHU as c
	join QuocGia as qg on qg.MAQG = c.MAQG
	join CAULACBO as clb on clb.MACLB = c.MACLB
where qg.TENQG != N'Việt Nam'
GROUP BY clb.MACLB, clb.TENCLB
-- cau 3
--Cho biết mã câu lạc bộ, tên câu lạc bộ, tên sân vận động, địa chỉ và số lượng cầu 
--thủ nước ngoài (có quốc tịch khác Việt Nam) tương ứng của các câu lạc bộ có nhiều 
--hơn 2 cầu thủ nước ngoài. 
SELECT CLB.MACLB,CLB.TENCLB, S.TENSAN, S.Diachi ,COUNT(*) as SoLuongCauthu
FROM CAULACBO as CLB 
	join SANVD as S on S.MASAN = CLB.MASAN
	join CAUTHU as C on C.MACLB = CLB.MACLB
	join Quocgia as qg on qg.MAQG = C.MAQG
where  qg.TENQG != N'Việt Nam' 
GROUP BY CLB.MACLB , CLB.TENCLB , s.TENSAN, s.DiaChi 
Having COUNT(*) > 2





